{
  "name": "option cdn_overlay_urls",
  "timeout": 240000,
  "origin": "test-proxy-cache-config.revsw.net",
  "tasks": {
    "create": {
      "command": "create",
      "description": "should create new configuration for domain",
      "delay": 0
    },
    "update": {
      "command": "update",
      "description": "should update configuration for domain",
      "set": {
        "3rd_party_rewrite": {
          "enable_3rd_party_root_rewrite": true,
          "3rd_party_root_rewrite_domains": "test-proxy-dsa-config.revsw.net"
        },
        "rev_component_co": {
          "enable_rum": true,
          "enable_optimization": false,
          "mode": "moderate",
          "img_choice": "medium",
          "js_choice": "medium",
          "css_choice": "medium"
        },
        "rev_component_bp": {
          "enable_cache": true,
          "block_crawlers": false,
          "cdn_overlay_urls": [
            "test-proxy-dsa-config.revsw.net"
          ],
          "caching_rules": [
            {
              "version": 1,
              "url": {
                "is_wildcard": true,
                "value": "**"
              },
              "edge_caching": {
                "override_origin": false,
                "new_ttl": 0,
                "override_no_cc": false
              },
              "browser_caching": {
                "override_edge": false,
                "new_ttl": 0,
                "force_revalidate": false
              },
              "cookies": {
                "override": false,
                "ignore_all": false,
                "list_is_keep": false,
                "keep_or_ignore_list": [],
                "remove_ignored_from_request": false,
                "remove_ignored_from_response": false
              }
            },
            {
              "version": 1,
              "url": {
                "value": "\\.(mp4|webp|js|css|woff)(\\?.*)?$",
                "is_wildcard": false
              },
              "edge_caching": {
                "new_ttl": 360000,
                "override_origin": true,
                "override_no_cc": true
              },
              "browser_caching": {
                "new_ttl": 0,
                "override_edge": false,
                "force_revalidate": false
              },
              "cookies": {
                "remove_ignored_from_request": true,
                "ignore_all": true,
                "remove_ignored_from_response": true,
                "override": true,
                "list_is_keep": false,
                "keep_or_ignore_list": []
              }
            },
            {
              "version": 1,
              "url": {
                "value": "\\.(dat|cgi)(\\?.*)?$",
                "is_wildcard": false
              },
              "edge_caching": {
                "new_ttl": 0,
                "override_origin": true,
                "override_no_cc": true
              },
              "browser_caching": {
                "new_ttl": 0,
                "override_edge": false,
                "force_revalidate": false
              },
              "cookies": {
                "remove_ignored_from_request": true,
                "ignore_all": true,
                "remove_ignored_from_response": true,
                "override": true,
                "list_is_keep": false,
                "keep_or_ignore_list": []
              }
            },
            {
              "version": 1,
              "url": {
                "value": "\\.(png|css)(\\?.*)?$",
                "is_wildcard": false
              },
              "edge_caching": {
                "new_ttl": 99999,
                "override_origin": true,
                "override_no_cc": true
              },
              "browser_caching": {
                "new_ttl": 0,
                "override_edge": false,
                "force_revalidate": false
              },
              "cookies": {
                "remove_ignored_from_request": true,
                "ignore_all": true,
                "remove_ignored_from_response": true,
                "override": true,
                "list_is_keep": false,
                "keep_or_ignore_list": []
              }
            },
            {
              "version": 1,
              "url": {
                "value": "\\.(jpg|jpeg|gif)(\\?.*)?$",
                "is_wildcard": false
              },
              "edge_caching": {
                "new_ttl": 37731,
                "override_origin": true,
                "override_no_cc": true
              },
              "browser_caching": {
                "new_ttl": 0,
                "override_edge": false,
                "force_revalidate": false
              },
              "cookies": {
                "remove_ignored_from_request": true,
                "ignore_all": true,
                "remove_ignored_from_response": true,
                "override": true,
                "list_is_keep": false,
                "keep_or_ignore_list": []
              }
            }
          ],
          "enable_security": true,
          "cache_bypass_locations": [
            "/bypass/"
          ]
        },
        "origin_host_header": "test-proxy-cache-config.revsw.net",
        "origin_server": "testsjc20-website01.revsw.net",
        "tolerance": "3000"
      },
      "delay": 0
    },
    "tests": {
      "command": "async",
      "description": "should make async test",
      "cases": {
        "case 1": {
          "display": true,
          "command": "check",
          "description": "should check overlay urls in html page",
          "delay": 0,
          "protocol": "HTTP",
          "check": {
            "url": "/parse.html",
            "header": [],
            "content": [
              "/rev-third-party-http/test-proxy-dsa-config.revsw.net/images-rw/1.jpg",
              "/rev-third-party-http/test-proxy-dsa-config.revsw.net/images-rw/2.jpg",
              "/rev-third-party-http/test-proxy-dsa-config.revsw.net/images-rw/3.jpg",
              "/rev-third-party-http/test-proxy-dsa-config.revsw.net/images-rw/4.jpg",
              "/rev-third-party-http/test-proxy-dsa-config.revsw.net/images-rw/5.jpg"
            ]
          }
        },
        "case 2": {
          "display": true,
          "command": "check",
          "description": "should check overlay url for 1 jpeg",
          "delay": 0,
          "protocol": "HTTPS",
          "check": {
            "url": "/rev-third-party-http/test-proxy-dsa-config.revsw.net/images-rw/1.jpg",
            "header": {
              "content-length": "110174",
              "x-rev-cache": "MISS",
              "x-rev-beresp-ttl": "37731.000",
              "cache-control": "public, max-age=37731",
              "content-type": "image/jpeg"
            },
            "text": []
          }
        },
        "case 3": {
          "display": true,
          "command": "check",
          "description": "should check overlay url for 2 jpeg",
          "delay": 0,
          "protocol": "HTTP",
          "check": {
            "url": "/rev-third-party-http/test-proxy-dsa-config.revsw.net/images-rw/2.jpg",
            "header": {
              "content-length": "60989",
              "x-rev-cache": "MISS",
              "x-rev-beresp-ttl": "37731.000",
              "cache-control": "public, max-age=37731",
              "content-type": "image/jpeg"
            },
            "text": []
          }
        },
        "case 4": {
          "display": true,
          "command": "check",
          "description": "should check overlay url for 3 jpeg",
          "delay": 0,
          "protocol": "HTTPS",
          "check": {
            "url": "/rev-third-party-http/test-proxy-dsa-config.revsw.net/images-rw/3.jpg",
            "header": {
              "content-length": "127000",
              "x-rev-cache": "MISS",
              "x-rev-beresp-ttl": "37731.000",
              "cache-control": "public, max-age=37731",
              "content-type": "image/jpeg"
            },
            "text": []
          }
        },
        "case 5": {
          "display": true,
          "command": "check",
          "description": "should check overlay url for 4 jpeg",
          "delay": 0,
          "protocol": "HTTP",
          "check": {
            "url": "/rev-third-party-http/test-proxy-dsa-config.revsw.net/images-rw/4.jpg",
            "header": {
              "content-length": "136746",
              "x-rev-cache": "MISS",
              "x-rev-beresp-ttl": "37731.000",
              "cache-control": "public, max-age=37731",
              "content-type": "image/jpeg"
            },
            "text": []
          }
        },
        "case 6": {
          "display": true,
          "command": "check",
          "description": "should check overlay url for 5 jpeg",
          "delay": 0,
          "protocol": "HTTPS",
          "check": {
            "url": "/rev-third-party-http/test-proxy-dsa-config.revsw.net/images-rw/5.jpg",
            "header": {
              "content-length": "141080",
              "x-rev-cache": "MISS",
              "x-rev-beresp-ttl": "37731.000",
              "cache-control": "public, max-age=37731",
              "content-type": "image/jpeg"
            },
            "text": []
          }
        }
      },
      "delay": 0
    },
    "delete": {
      "command": "delete",
      "description": "should delete the domain config",
      "delay": 0
    }
  }
}